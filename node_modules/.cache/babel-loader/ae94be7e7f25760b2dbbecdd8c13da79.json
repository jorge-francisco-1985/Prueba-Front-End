{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createReactClass = require('create-react-class');\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _d = require('d3');\n\nvar _d2 = _interopRequireDefault(_d);\n\nvar _Chart = require('./Chart');\n\nvar _Chart2 = _interopRequireDefault(_Chart);\n\nvar _Tooltip = require('./Tooltip');\n\nvar _Tooltip2 = _interopRequireDefault(_Tooltip);\n\nvar _DefaultPropsMixin = require('./DefaultPropsMixin');\n\nvar _DefaultPropsMixin2 = _interopRequireDefault(_DefaultPropsMixin);\n\nvar _HeightWidthMixin = require('./HeightWidthMixin');\n\nvar _HeightWidthMixin2 = _interopRequireDefault(_HeightWidthMixin);\n\nvar _AccessorMixin = require('./AccessorMixin');\n\nvar _AccessorMixin2 = _interopRequireDefault(_AccessorMixin);\n\nvar _TooltipMixin = require('./TooltipMixin');\n\nvar _TooltipMixin2 = _interopRequireDefault(_TooltipMixin);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar string = _propTypes2.default.string,\n    array = _propTypes2.default.array,\n    number = _propTypes2.default.number,\n    bool = _propTypes2.default.bool,\n    func = _propTypes2.default.func,\n    any = _propTypes2.default.any;\nvar Wedge = (0, _createReactClass2.default)({\n  displayName: 'Wedge',\n  propTypes: {\n    d: string.isRequired,\n    fill: string.isRequired\n  },\n  render: function render() {\n    var _props = this.props,\n        fill = _props.fill,\n        d = _props.d,\n        data = _props.data,\n        onMouseEnter = _props.onMouseEnter,\n        _onMouseLeave = _props.onMouseLeave;\n    return _react2.default.createElement('path', {\n      fill: fill,\n      d: d,\n      onMouseMove: function onMouseMove(evt) {\n        return onMouseEnter(evt, data);\n      },\n      onMouseLeave: function onMouseLeave(evt) {\n        return _onMouseLeave(evt);\n      }\n    });\n  }\n});\nvar DataSet = (0, _createReactClass2.default)({\n  displayName: 'DataSet',\n  propTypes: {\n    pie: array.isRequired,\n    arc: func.isRequired,\n    outerArc: func.isRequired,\n    colorScale: func.isRequired,\n    radius: number.isRequired,\n    strokeWidth: number,\n    stroke: string,\n    fill: string,\n    opacity: number,\n    x: func.isRequired,\n    hideLabels: bool\n  },\n  getDefaultProps: function getDefaultProps() {\n    return {\n      strokeWidth: 2,\n      stroke: '#000',\n      fill: 'none',\n      opacity: 0.3,\n      hideLabels: false\n    };\n  },\n  renderLabel: function renderLabel(wedge) {\n    var _props2 = this.props,\n        arc = _props2.arc,\n        outerArc = _props2.outerArc,\n        radius = _props2.radius,\n        strokeWidth = _props2.strokeWidth,\n        stroke = _props2.stroke,\n        fill = _props2.fill,\n        opacity = _props2.opacity,\n        x = _props2.x;\n    var labelPos = outerArc.centroid(wedge);\n    labelPos[0] = radius * (this.midAngle(wedge) < Math.PI ? 1 : -1);\n    var linePos = outerArc.centroid(wedge);\n    linePos[0] = radius * 0.95 * (this.midAngle(wedge) < Math.PI ? 1 : -1);\n    var textAnchor = this.midAngle(wedge) < Math.PI ? 'start' : 'end';\n    return _react2.default.createElement('g', null, _react2.default.createElement('polyline', {\n      opacity: opacity,\n      strokeWidth: strokeWidth,\n      stroke: stroke,\n      fill: fill,\n      points: [arc.centroid(wedge), outerArc.centroid(wedge), linePos]\n    }), _react2.default.createElement('text', {\n      dy: '.35em',\n      x: labelPos[0],\n      y: labelPos[1],\n      textAnchor: textAnchor\n    }, x(wedge.data)));\n  },\n  render: function render() {\n    var _this = this;\n\n    var _props3 = this.props,\n        pie = _props3.pie,\n        arc = _props3.arc,\n        colorScale = _props3.colorScale,\n        x = _props3.x,\n        y = _props3.y,\n        onMouseEnter = _props3.onMouseEnter,\n        onMouseLeave = _props3.onMouseLeave,\n        hideLabels = _props3.hideLabels;\n    var wedges = pie.map(function (e, index) {\n      var labelFits = e.endAngle - e.startAngle >= 10 * Math.PI / 180;\n      return _react2.default.createElement('g', {\n        key: x(e.data) + '.' + y(e.data) + '.' + index,\n        className: 'arc'\n      }, _react2.default.createElement(Wedge, {\n        data: e.data,\n        fill: colorScale(x(e.data)),\n        d: arc(e),\n        onMouseEnter: onMouseEnter,\n        onMouseLeave: onMouseLeave\n      }), !hideLabels && !!e.value && labelFits && _this.renderLabel(e));\n    });\n    return _react2.default.createElement('g', null, wedges);\n  },\n  midAngle: function midAngle(d) {\n    return d.startAngle + (d.endAngle - d.startAngle) / 2;\n  }\n});\nvar PieChart = (0, _createReactClass2.default)({\n  displayName: 'PieChart',\n  mixins: [_DefaultPropsMixin2.default, _HeightWidthMixin2.default, _AccessorMixin2.default, _TooltipMixin2.default],\n  propTypes: {\n    innerRadius: number,\n    outerRadius: number,\n    labelRadius: number,\n    padRadius: string,\n    cornerRadius: number,\n    sort: any,\n    hideLabels: bool\n  },\n  getDefaultProps: function getDefaultProps() {\n    return {\n      innerRadius: null,\n      outerRadius: null,\n      labelRadius: null,\n      padRadius: 'auto',\n      cornerRadius: 0,\n      sort: undefined,\n      hideLabels: false\n    };\n  },\n  _tooltipHtml: function _tooltipHtml(d) {\n    var html = this.props.tooltipHtml(this.props.x(d), this.props.y(d));\n    return [html, 0, 0];\n  },\n  render: function render() {\n    var _props4 = this.props,\n        data = _props4.data,\n        width = _props4.width,\n        height = _props4.height,\n        margin = _props4.margin,\n        viewBox = _props4.viewBox,\n        preserveAspectRatio = _props4.preserveAspectRatio,\n        colorScale = _props4.colorScale,\n        padRadius = _props4.padRadius,\n        cornerRadius = _props4.cornerRadius,\n        sort = _props4.sort,\n        x = _props4.x,\n        y = _props4.y,\n        values = _props4.values,\n        hideLabels = _props4.hideLabels;\n    var _props5 = this.props,\n        innerRadius = _props5.innerRadius,\n        outerRadius = _props5.outerRadius,\n        labelRadius = _props5.labelRadius;\n    var innerWidth = this._innerWidth;\n    var innerHeight = this._innerHeight;\n\n    var pie = _d2.default.layout.pie().value(function (e) {\n      return y(e);\n    });\n\n    if (typeof sort !== 'undefined') {\n      pie = pie.sort(sort);\n    }\n\n    var radius = Math.min(innerWidth, innerHeight) / 2;\n\n    if (!innerRadius) {\n      innerRadius = radius * 0.8;\n    }\n\n    if (!outerRadius) {\n      outerRadius = radius * 0.4;\n    }\n\n    if (!labelRadius) {\n      labelRadius = radius * 0.9;\n    }\n\n    var arc = _d2.default.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius).padRadius(padRadius).cornerRadius(cornerRadius);\n\n    var outerArc = _d2.default.svg.arc().innerRadius(labelRadius).outerRadius(labelRadius);\n\n    var pieData = pie(values(data));\n    var translation = 'translate(' + innerWidth / 2 + ', ' + innerHeight / 2 + ')';\n    return _react2.default.createElement('div', null, _react2.default.createElement(_Chart2.default, {\n      height: height,\n      width: width,\n      margin: margin,\n      viewBox: viewBox,\n      preserveAspectRatio: preserveAspectRatio\n    }, _react2.default.createElement('g', {\n      transform: translation\n    }, _react2.default.createElement(DataSet, {\n      width: innerWidth,\n      height: innerHeight,\n      colorScale: colorScale,\n      pie: pieData,\n      arc: arc,\n      outerArc: outerArc,\n      radius: radius,\n      x: x,\n      y: y,\n      onMouseEnter: this.onMouseEnter,\n      onMouseLeave: this.onMouseLeave,\n      hideLabels: hideLabels\n    })), this.props.children), _react2.default.createElement(_Tooltip2.default, this.state.tooltip));\n  }\n});\nexports.default = PieChart;","map":null,"metadata":{},"sourceType":"script"}